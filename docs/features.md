# 功能特性

本系统提供了一套完整而强大的功能，旨在简化 Telegraf 的配置、管理和监控。以下是核心功能的详细列表。

## 1. 配置管理 (Configuration Management)

- **版本控制与追溯 (Versioning & History)**
  - 对配置文件的每一次修改（无论是手动编辑还是通过向导生成）都会自动创建新的版本。
  - 提供完整的版本历史列表，清晰展示版本号、变更时间、变更说明。
  - 支持一键将任意历史版本激活为当前使用的版本，实现快速回滚。

- **在线编辑器与预览 (Online Editor & Preview)**
  - 内置强大的 Web 编辑器，支持 TOML 语法高亮。
  - **分段式编辑**：自动将复杂的配置文件按插件（如 `[[inputs.cpu]]`）分割成可折叠的代码块，便于导航和编辑。
  - **数据快照预览**：在不启动进程的情况下，运行一次数据采集并预览输出的指标，是验证和调试输入插件（特别是 OPC-UA、Modbus 等）的利器。

- **安全与稳定 (Security & Stability)**
  - **配置锁定**：可将生产环境中正在使用的重要配置文件锁定，防止其被意外编辑、删除或关联到其他进程。
  - **后台验证**：保存文件时，系统会在后台异步执行 `telegraf --test` 命令验证配置文件的语法和插件设置，不阻塞用户操作，并通过通知反馈验证结果。

## 2. 数据点管理 (Data Point Management)

- **向导式提取 (Wizard-based Extraction)**
  - 从复杂的 Telegraf 配置文件（特别是 OPC-UA）中智能提取数据点。
  - 通过交互式界面，将 TOML 文件中的任意字段映射到系统数据点的标准字段上。

- **状态智能检查 (Intelligent Status Checking)**
  - 在向导的预览步骤中，自动检查每个待导入数据点与数据库中现有数据的关系。
  - 明确标识**新点位**、**可合并**（已存在但未关联）、**冲突**（已关联到其他配置）、**内部重复**等状态，并引导用户解决冲突。

- **安全导入与回滚 (Safe Import & Rollback)**
  - 所有通过向导或批量导入的数据都会被记录在一个唯一的“批次”中。
  - 提供完整的导入历史记录，并支持对任意批次进行一键式、非破坏性的**安全回滚**操作。

- **全面的数据点信息 (Comprehensive Metadata)**
  - 支持管理数据点的多种元数据，包括测量名、原始点名、标准化点名、单位、数据类型、注释等。
  - 记录每个数据点的变更历史，方便审计和追溯。

## 3. 进程管理 (Process Management)

- **统一进程视图 (Unified Process View)**
  - 自动发现并展示所有正在运行的 Telegraf 进程。
  - **系统管理进程**：通过本系统UI启动的进程，拥有完整的生命周期控制权限。
  - **非系统管理进程**：由其他方式（如 systemd 服务）启动的进程，本系统提供监控和有限的控制能力，以避免冲突。

- **实时状态监控 (Real-time Status Monitoring)**
  - 在一个界面中实时展示所有进程的运行状态、PID、运行时长、CPU 使用率、内存占用等关键性能指标。

- **安全的生命周期控制 (Safe Lifecycle Control)**
  - 支持对“系统管理进程”进行启动、停止、重启操作。
  - **重启前测试**：在重启进程前，提供“测试配置”功能，确保新配置的有效性，只有测试通过后才允许“安全重启”，最大限度地避免因配置错误导致监控中断。

- **在线日志查看 (Online Log Viewer)**
  - 无需登录服务器，直接在 Web 界面上查看指定进程的实时日志输出，极大地方便了日常监控和故障排查。

## 4. 系统与集成 (System & Integration)

- **仪表盘 (Dashboard)**
  - 提供一个信息丰富的仪表盘，集中展示系统健康状态、关键指标、最近的审计活动和运行中的进程概览。

- **审计日志 (Audit Log)**
  - 自动记录所有用户的关键操作，如登录、配置文件修改、进程启停、数据点导入等，便于安全审计和问题追溯。

- **数据库管理 (Database Management)**
  - 内置数据库备份和恢复机制。
  - 使用 Flask-Migrate 和 Alembic 管理数据库结构变更，确保更新平滑。
